# uploda and recive data from Mindsphere using PAI

from http.client import HTTPSConnection
from base64 import b64encode
import urllib.request as req

AUTH = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImtleS1pZC0xIiwidHlwIjoiSldUIn0.eyJqdGkiOiJmYjUxZjJlZTBhYWI0ZDlkOWE4ODk1NTQwNGFmNzM1YiIsInN1YiI6IjJjN2Y2ZWJjLWZiMTktNGFkOS1hZDUwLThjMTNhZTdhZjlkMCIsInNjb3BlIjpbInVhYS5vZmZsaW5lX3Rva2VuIiwibWRzcDpjb3JlOmlvdC50c2FVc2VyIiwibWRzcDpjb3JlOmFzc2V0bWFuYWdlbWVudC5zdGFuZGFyZHVzZXIiXSwiY2xpZW50X2lkIjoidG9rZW5hcHB0Yi1zb2NnZXJkZSIsImNpZCI6InRva2VuYXBwdGItc29jZ2VyZGUiLCJhenAiOiJ0b2tlbmFwcHRiLXNvY2dlcmRlIiwiZ3JhbnRfdHlwZSI6ImF1dGhvcml6YXRpb25fY29kZSIsInVzZXJfaWQiOiIyYzdmNmViYy1mYjE5LTRhZDktYWQ1MC04YzEzYWU3YWY5ZDAiLCJvcmlnaW4iOiJzb2NnZXJkZSIsInVzZXJfbmFtZSI6IkJvbWJhdGthci52aXZla0BnbWFpbC5jb20iLCJlbWFpbCI6IkJvbWJhdGthci52aXZla0BnbWFpbC5jb20iLCJhdXRoX3RpbWUiOjE1MzEyNDM2OTEsInJldl9zaWciOiI1OTIxZTkyYyIsImlhdCI6MTUzMTI0MzY5MSwiZXhwIjoxNTMxMjQ1NDkxLCJpc3MiOiJodHRwczovL3NvY2dlcmRlLnBpYW0uZXUxLm1pbmRzcGhlcmUuaW8vb2F1dGgvdG9rZW4iLCJ6aWQiOiJzb2NnZXJkZSIsImF1ZCI6WyJtZHNwOmNvcmU6aW90IiwidWFhIiwibWRzcDpjb3JlOmFzc2V0bWFuYWdlbWVudCIsInRva2VuYXBwdGItc29jZ2VyZGUiXSwidGVuIjoic29jZ2VyZGUiLCJzY2hlbWFzIjpbInVybjpzaWVtZW5zOm1pbmRzcGhlcmU6aWFtOnYxIl0sImNhdCI6InVzZXItdG9rZW46djEifQ.OJHWRob0uPL6P53wCa0hHasGiwlQE0ETAXFeDk9oUlYL7ip2sivOyVHs2pp4ADM6h1tSjSAgoP7SStez-cdtEdvKWn-ceez0xj0MfkPga-5OeOhaYEztYiOi39N8aAaGSdQx2F5L4G7tdJ4BppLCa8XB0yelA6sx2hlmUZFxOSsKqp9JR_-jxAPYGS12vInE-g1QWfzF4lTDIab0qoJ9jmHTxHJMAFHXoK1nNJ-2lMDTJmUjYjgu20M3qiBqoC51eNVZPPuwVRA9sIYZUI2Pqekh-D5gHdYqm3VfRKCBBC3uBK_iZA18ZNpmCfvRpDYLZvi2MNHFDGnUydRohKZlbQ"
CONNECTION_URL = "https://gateway.eu1.mindsphere.io/api/iotfile/v3/files/a2385c36630a48e698622be19e3f5a3c/data_file.csv	"
file_data = req.urlopen(CONNECTION_URL)

'''
#This sets up the https connection
c = HTTPSConnection(CONNECTION_URL)
#we need to base 64 encode it
#and then decode it to acsii as python 3 stores it as a byte string
userAndPass = b64encode(b"eyJhbGciOiJSUzI1NiIsImtpZCI6ImtleS1pZC0xIiwidHlwIjoiSldUIn0.eyJqdGkiOiJmYjUxZjJlZTBhYWI0ZDlkOWE4ODk1NTQwNGFmNzM1YiIsInN1YiI6IjJjN2Y2ZWJjLWZiMTktNGFkOS1hZDUwLThjMTNhZTdhZjlkMCIsInNjb3BlIjpbInVhYS5vZmZsaW5lX3Rva2VuIiwibWRzcDpjb3JlOmlvdC50c2FVc2VyIiwibWRzcDpjb3JlOmFzc2V0bWFuYWdlbWVudC5zdGFuZGFyZHVzZXIiXSwiY2xpZW50X2lkIjoidG9rZW5hcHB0Yi1zb2NnZXJkZSIsImNpZCI6InRva2VuYXBwdGItc29jZ2VyZGUiLCJhenAiOiJ0b2tlbmFwcHRiLXNvY2dlcmRlIiwiZ3JhbnRfdHlwZSI6ImF1dGhvcml6YXRpb25fY29kZSIsInVzZXJfaWQiOiIyYzdmNmViYy1mYjE5LTRhZDktYWQ1MC04YzEzYWU3YWY5ZDAiLCJvcmlnaW4iOiJzb2NnZXJkZSIsInVzZXJfbmFtZSI6IkJvbWJhdGthci52aXZla0BnbWFpbC5jb20iLCJlbWFpbCI6IkJvbWJhdGthci52aXZla0BnbWFpbC5jb20iLCJhdXRoX3RpbWUiOjE1MzEyNDM2OTEsInJldl9zaWciOiI1OTIxZTkyYyIsImlhdCI6MTUzMTI0MzY5MSwiZXhwIjoxNTMxMjQ1NDkxLCJpc3MiOiJodHRwczovL3NvY2dlcmRlLnBpYW0uZXUxLm1pbmRzcGhlcmUuaW8vb2F1dGgvdG9rZW4iLCJ6aWQiOiJzb2NnZXJkZSIsImF1ZCI6WyJtZHNwOmNvcmU6aW90IiwidWFhIiwibWRzcDpjb3JlOmFzc2V0bWFuYWdlbWVudCIsInRva2VuYXBwdGItc29jZ2VyZGUiXSwidGVuIjoic29jZ2VyZGUiLCJzY2hlbWFzIjpbInVybjpzaWVtZW5zOm1pbmRzcGhlcmU6aWFtOnYxIl0sImNhdCI6InVzZXItdG9rZW46djEifQ.OJHWRob0uPL6P53wCa0hHasGiwlQE0ETAXFeDk9oUlYL7ip2sivOyVHs2pp4ADM6h1tSjSAgoP7SStez-cdtEdvKWn-ceez0xj0MfkPga-5OeOhaYEztYiOi39N8aAaGSdQx2F5L4G7tdJ4BppLCa8XB0yelA6sx2hlmUZFxOSsKqp9JR_-jxAPYGS12vInE-g1QWfzF4lTDIab0qoJ9jmHTxHJMAFHXoK1nNJ-2lMDTJmUjYjgu20M3qiBqoC51eNVZPPuwVRA9sIYZUI2Pqekh-D5gHdYqm3VfRKCBBC3uBK_iZA18ZNpmCfvRpDYLZvi2MNHFDGnUydRohKZlbQ").decode("ascii")
headers = { 'Authorization' : 'Basic %s' %  userAndPass }
#then connect
c.request('GET', '/', headers=headers)
#get the response back
res = c.getresponse()
# at this point you could check the status etc
# this gets the page text
data = res.read()
print(file_data)

'''
